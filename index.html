<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="FORGE Brief">
<title>FORGE HEALTH ‚Äî Daily Briefing</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap');
  * { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --forge-primary: #0D1B2A;
    --forge-accent: #2EC4B6;
    --forge-accent-light: #3DD8C8;
    --forge-accent-glow: rgba(46,196,182,0.15);
    --forge-surface: #1B2838;
    --forge-surface-2: #2A3A4E;
    --forge-border: #3D5068;
    --forge-text: #F1F5F9;
    --forge-text-secondary: #94A3B8;
    --forge-text-muted: #64748B;
    --forge-success: #10B981;
    --forge-warning: #F59E0B;
    --forge-danger: #EF4444;
    --forge-purple: #8B5CF6;
    --forge-cyan: #06B6D4;
    --forge-gradient: linear-gradient(135deg, #2EC4B6 0%, #1A9E93 50%, #0D7377 100%);
    --radius: 16px;
    --radius-sm: 10px;
  }
  body { font-family: 'Inter', -apple-system, sans-serif; background: var(--forge-primary); color: var(--forge-text); min-height: 100vh; overflow-x: hidden; -webkit-font-smoothing: antialiased; }

  /* Header */
  .header { background: var(--forge-primary); padding: 20px 20px 0; position: sticky; top: 0; z-index: 50; border-bottom: 1px solid rgba(71,85,105,0.3); }
  .header-brand { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
  .header-logo { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; font-size: 1.6rem; }
  .header-title { font-family: 'Space Grotesk', sans-serif; font-size: 1.1rem; font-weight: 700; letter-spacing: -0.3px; }
  .header-title .forge { color: var(--forge-text); }
  .header-title .health { color: var(--forge-accent); }
  .header-subtitle { font-size: 0.7rem; color: var(--forge-text-muted); font-weight: 400; letter-spacing: 1.5px; text-transform: uppercase; }

  /* Date Navigation */
  .date-nav { display: flex; align-items: center; gap: 12px; padding-bottom: 14px; }
  .date-nav-btn { background: var(--forge-surface); border: 1px solid var(--forge-border); color: var(--forge-text-secondary); width: 36px; height: 36px; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1rem; transition: all 0.2s; -webkit-tap-highlight-color: transparent; }
  .date-nav-btn:active { background: var(--forge-surface-2); }
  .date-nav-btn.disabled { opacity: 0.3; pointer-events: none; }
  .date-display { flex: 1; }
  .date-display .date-main { font-family: 'Space Grotesk', sans-serif; font-size: 1.3rem; font-weight: 700; }
  .date-display .date-sub { font-size: 0.75rem; color: var(--forge-text-muted); margin-top: 2px; }

  /* Container */
  .container { max-width: 600px; margin: 0 auto; padding: 16px 16px 120px; }

  /* Section Headers */
  .section { margin-bottom: 24px; }
  .section-label { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; }
  .section-icon { font-size: 0.85rem; width: 28px; height: 28px; background: var(--forge-accent-glow); border-radius: 8px; display: flex; align-items: center; justify-content: center; }
  .section-icon.idea { background: rgba(245,158,11,0.15); }
  .section-icon.articles { background: rgba(59,130,246,0.15); }
  .section-icon.linkedin { background: rgba(139,92,246,0.15); }
  .section-icon.events { background: rgba(6,182,212,0.15); }
  .section-icon.mindset { background: rgba(16,185,129,0.15); }
  .section-icon.video { background: rgba(239,68,68,0.15); }
  .section-title { font-family: 'Space Grotesk', sans-serif; font-size: 0.8rem; font-weight: 600; color: var(--forge-text-muted); text-transform: uppercase; letter-spacing: 1.5px; }

  /* Cards */
  .card { background: var(--forge-surface); border: 1px solid rgba(71,85,105,0.4); border-radius: var(--radius); padding: 18px; margin-bottom: 10px; transition: all 0.2s; position: relative; overflow: hidden; }
  .card:active { transform: scale(0.99); }
  .card::before { content: ''; position: absolute; top: 0; left: 0; width: 3px; height: 100%; border-radius: 3px 0 0 3px; }
  .card.idea-card::before { background: var(--forge-warning); }
  .card.article-card::before { background: var(--forge-accent); }
  .card.linkedin-card::before { background: var(--forge-purple); }
  .card.event-card::before { background: var(--forge-cyan); }
  .card.quote-card::before { background: var(--forge-success); }
  .card.video-card::before { background: var(--forge-danger); }

  .card-header { display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; }
  .card-title { font-family: 'Space Grotesk', sans-serif; font-size: 1rem; font-weight: 600; line-height: 1.4; color: var(--forge-text); }
  .card-source { font-size: 0.72rem; color: var(--forge-text-muted); margin-top: 4px; }
  .card-body { font-size: 0.85rem; color: var(--forge-text-secondary); line-height: 1.6; margin-top: 10px; }
  .card-body a { color: var(--forge-accent-light); text-decoration: none; }

  /* Scores */
  .scores-row { display: flex; gap: 8px; margin-top: 12px; flex-wrap: wrap; }
  .score-badge { background: var(--forge-surface-2); padding: 4px 10px; border-radius: 8px; font-size: 0.72rem; font-weight: 600; display: flex; align-items: center; gap: 4px; }
  .score-badge .score-val { color: var(--forge-warning); }
  .score-badge .score-label { color: var(--forge-text-muted); }

  /* Verdict */
  .verdict { display: inline-flex; align-items: center; gap: 6px; margin-top: 12px; padding: 6px 12px; border-radius: 8px; font-size: 0.78rem; font-weight: 600; }
  .verdict.skip { background: rgba(239,68,68,0.1); color: var(--forge-danger); border: 1px solid rgba(239,68,68,0.2); }
  .verdict.build { background: rgba(16,185,129,0.1); color: var(--forge-success); border: 1px solid rgba(16,185,129,0.2); }
  .verdict.watch { background: rgba(245,158,11,0.1); color: var(--forge-warning); border: 1px solid rgba(245,158,11,0.2); }

  /* Healthcare Angle */
  .healthcare-angle { background: rgba(59,130,246,0.08); border: 1px solid rgba(59,130,246,0.15); border-radius: var(--radius-sm); padding: 12px; margin-top: 12px; }
  .healthcare-angle .label { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: var(--forge-accent-light); font-weight: 600; margin-bottom: 4px; }
  .healthcare-angle p { font-size: 0.82rem; color: var(--forge-text-secondary); line-height: 1.5; }

  /* Action Buttons */
  .card-actions { display: flex; gap: 8px; margin-top: 14px; flex-wrap: wrap; }
  .action-btn { background: var(--forge-surface-2); border: 1px solid var(--forge-border); color: var(--forge-text-secondary); padding: 7px 14px; border-radius: 8px; font-size: 0.75rem; font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 5px; transition: all 0.2s; -webkit-tap-highlight-color: transparent; }
  .action-btn:active { background: var(--forge-accent); color: white; border-color: var(--forge-accent); }
  .action-btn.saved { background: rgba(16,185,129,0.15); color: var(--forge-success); border-color: rgba(16,185,129,0.3); }
  .action-btn.primary { background: var(--forge-accent); color: white; border-color: var(--forge-accent); }

  /* Quote Card */
  .quote-text { font-family: 'Space Grotesk', sans-serif; font-size: 1.15rem; font-weight: 500; line-height: 1.5; color: var(--forge-text); font-style: italic; }
  .quote-author { font-size: 0.8rem; color: var(--forge-accent-light); margin-top: 10px; font-weight: 500; }
  .quote-reflection { font-size: 0.85rem; color: var(--forge-text-secondary); line-height: 1.6; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(71,85,105,0.3); }

  /* Tags */
  .tags { display: flex; gap: 6px; margin-top: 10px; flex-wrap: wrap; }
  .tag { font-size: 0.68rem; padding: 3px 8px; border-radius: 6px; background: var(--forge-surface-2); color: var(--forge-text-muted); font-weight: 500; }
  .tag.governance { background: rgba(139,92,246,0.15); color: var(--forge-purple); }
  .tag.clinical { background: rgba(6,182,212,0.15); color: var(--forge-cyan); }
  .tag.decision { background: rgba(245,158,11,0.15); color: var(--forge-warning); }

  /* LinkedIn Post Modal */
  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 100; display: none; align-items: flex-end; justify-content: center; backdrop-filter: blur(4px); }
  .modal-overlay.show { display: flex; }
  .modal { background: var(--forge-surface); border-radius: 20px 20px 0 0; width: 100%; max-width: 600px; max-height: 80vh; overflow-y: auto; padding: 20px; animation: slideUp 0.3s ease; }
  @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
  .modal-handle { width: 40px; height: 4px; background: var(--forge-border); border-radius: 4px; margin: 0 auto 16px; }
  .modal h3 { font-family: 'Space Grotesk', sans-serif; font-size: 1rem; margin-bottom: 12px; }
  .modal-post { background: var(--forge-primary); border: 1px solid var(--forge-border); border-radius: var(--radius-sm); padding: 16px; font-size: 0.85rem; color: var(--forge-text-secondary); line-height: 1.6; white-space: pre-wrap; margin-bottom: 12px; }
  .modal-actions { display: flex; gap: 8px; }
  .modal-btn { flex: 1; padding: 12px; border-radius: 10px; font-size: 0.85rem; font-weight: 600; cursor: pointer; border: none; text-align: center; -webkit-tap-highlight-color: transparent; }
  .modal-btn.copy { background: var(--forge-accent); color: white; }
  .modal-btn.close { background: var(--forge-surface-2); color: var(--forge-text-secondary); }

  /* Saved Page */
  .saved-empty { text-align: center; padding: 40px 20px; color: var(--forge-text-muted); }
  .saved-empty .icon { font-size: 2.5rem; margin-bottom: 12px; }

  /* Bottom Nav */
  .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: var(--forge-primary); border-top: 1px solid rgba(71,85,105,0.3); display: flex; z-index: 60; padding-bottom: env(safe-area-inset-bottom); backdrop-filter: blur(20px); }
  .nav-btn { flex: 1; text-align: center; padding: 10px 0 8px; cursor: pointer; -webkit-tap-highlight-color: transparent; transition: all 0.2s; }
  .nav-btn .nav-icon { font-size: 1.2rem; opacity: 0.5; transition: all 0.2s; }
  .nav-btn .nav-label { font-size: 0.6rem; color: var(--forge-text-muted); margin-top: 3px; letter-spacing: 0.5px; }
  .nav-btn.active .nav-icon { opacity: 1; }
  .nav-btn.active .nav-label { color: var(--forge-accent-light); font-weight: 600; }

  /* Tab pages */
  .tab-page { display: none; }
  .tab-page.active { display: block; }

  /* Loading */
  .loading { text-align: center; padding: 60px 20px; }
  .loading-spinner { width: 32px; height: 32px; border: 3px solid var(--forge-surface-2); border-top-color: var(--forge-accent); border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 12px; }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* No data */
  .no-data { text-align: center; padding: 60px 20px; color: var(--forge-text-muted); }
  .no-data .icon { font-size: 2rem; margin-bottom: 8px; }

  /* Revenue estimate */
  .revenue { display: inline-flex; align-items: center; gap: 4px; background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.2); padding: 4px 10px; border-radius: 8px; font-size: 0.75rem; font-weight: 600; color: var(--forge-success); margin-top: 8px; }

  /* Expand/collapse for details */
  .expandable { cursor: pointer; }
  .expand-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
  .expanded .expand-content { max-height: 1000px; }
  .expand-hint { font-size: 0.68rem; color: var(--forge-text-muted); margin-top: 8px; }
  .expanded .expand-hint { display: none; }
  .priority-badge { display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; border-radius: 6px; font-size: 0.68rem; font-weight: 600; margin-top: 8px; }
  .priority-badge.high { background: rgba(239,68,68,0.15); color: var(--forge-danger); }
  .priority-badge.medium { background: rgba(245,158,11,0.15); color: var(--forge-warning); }
</style>
</head>
<body>

<div class="header">
  <div class="header-brand">
    <div class="header-logo">üî•</div>
    <div>
      <div class="header-title"><span class="forge">FORGE</span> <span class="health">HEALTH</span></div>
      <div class="header-subtitle">Daily Intelligence Briefing</div>
    </div>
  </div>
  <div class="date-nav">
    <div class="date-nav-btn" id="prevDay" onclick="navigateDay(-1)">‚Üê</div>
    <div class="date-display">
      <div class="date-main" id="dateMain">January 31, 2026</div>
      <div class="date-sub" id="dateSub">Friday ¬∑ Briefing #1</div>
    </div>
    <div class="date-nav-btn disabled" id="nextDay" onclick="navigateDay(1)">‚Üí</div>
  </div>
</div>

<div class="container">
  <div class="tab-page active" id="tab-today"></div>
  <div class="tab-page" id="tab-saved"></div>
</div>

<!-- LinkedIn Post Modal -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
  <div class="modal" onclick="event.stopPropagation()">
    <div class="modal-handle"></div>
    <h3>‚úçÔ∏è Suggested LinkedIn Post</h3>
    <div class="modal-post" id="modalPost"></div>
    <div class="modal-actions">
      <div class="modal-btn close" onclick="closeModal()">Close</div>
      <div class="modal-btn copy" onclick="copyPost()">üìã Copy to Clipboard</div>
    </div>
  </div>
</div>

<div class="bottom-nav">
  <div class="nav-btn active" onclick="switchTab('today')"><div class="nav-icon">üìä</div><div class="nav-label">Today</div></div>
  <div class="nav-btn" onclick="switchTab('saved')"><div class="nav-icon">üíæ</div><div class="nav-label">Saved</div></div>
</div>

<script>
var DATA_CACHE = {};
var AVAILABLE_DATES = [];
var currentDateIdx = 0;
var savedItems = JSON.parse(localStorage.getItem('forge_saved') || '[]');

// Discover available briefing dates
async function discoverDates() {
  // Start from today, go back 30 days
  var dates = [];
  var d = new Date();
  for (var i = 0; i < 30; i++) {
    var key = d.toISOString().split('T')[0];
    dates.push(key);
    d.setDate(d.getDate() - 1);
  }
  // Try to load each, stop at first gap after finding at least one
  var found = [];
  for (var j = 0; j < dates.length; j++) {
    try {
      var resp = await fetch('data/' + dates[j] + '.json');
      if (resp.ok) {
        var data = await resp.json();
        DATA_CACHE[dates[j]] = data;
        found.push(dates[j]);
      }
    } catch(e) {}
  }
  AVAILABLE_DATES = found;
  if (found.length > 0) {
    currentDateIdx = 0;
    renderBriefing(found[0]);
    updateNav();
  } else {
    document.getElementById('tab-today').innerHTML = '<div class="no-data"><div class="icon">üì≠</div><div>No briefings yet. Check back tomorrow morning.</div></div>';
  }
}

function navigateDay(dir) {
  var newIdx = currentDateIdx - dir; // dates are newest-first
  if (newIdx >= 0 && newIdx < AVAILABLE_DATES.length) {
    currentDateIdx = newIdx;
    renderBriefing(AVAILABLE_DATES[currentDateIdx]);
    updateNav();
    window.scrollTo(0, 0);
  }
}

function updateNav() {
  var prev = document.getElementById('prevDay');
  var next = document.getElementById('nextDay');
  prev.className = 'date-nav-btn' + (currentDateIdx >= AVAILABLE_DATES.length - 1 ? ' disabled' : '');
  next.className = 'date-nav-btn' + (currentDateIdx <= 0 ? ' disabled' : '');
}

function formatDate(dateStr) {
  var d = new Date(dateStr + 'T12:00:00');
  var days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  return { full: months[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear(), day: days[d.getDay()] };
}

function renderBriefing(dateStr) {
  var data = DATA_CACHE[dateStr];
  if (!data) return;
  var fd = formatDate(dateStr);
  var briefNum = AVAILABLE_DATES.length - AVAILABLE_DATES.indexOf(dateStr);
  document.getElementById('dateMain').textContent = fd.full;
  document.getElementById('dateSub').textContent = fd.day + ' ¬∑ Briefing #' + briefNum;

  var html = '';

  // QUOTE (top for motivation)
  if (data.quote) {
    html += '<div class="section"><div class="section-label"><div class="section-icon mindset">üßò</div><div class="section-title">Mindset</div></div>';
    html += '<div class="card quote-card"><div class="quote-text">"' + esc(data.quote.text) + '"</div>';
    html += '<div class="quote-author">‚Äî ' + esc(data.quote.author) + (data.quote.source ? ', ' + esc(data.quote.source) : '') + '</div>';
    if (data.quote.reflection) html += '<div class="quote-reflection">' + esc(data.quote.reflection) + '</div>';
    html += '</div></div>';
  }

  // IDEA
  if (data.idea) {
    var idea = data.idea;
    html += '<div class="section"><div class="section-label"><div class="section-icon idea">üí°</div><div class="section-title">Idea of the Day</div></div>';
    html += '<div class="card idea-card expandable" onclick="toggleExpand(this)">';
    html += '<div class="card-header"><div><div class="card-title">' + esc(idea.title) + '</div>';
    html += '<div class="card-source">' + esc(idea.source) + '</div></div></div>';
    html += '<div class="card-body">' + esc(idea.summary) + '</div>';
    html += '<div class="scores-row">';
    if (idea.scores) {
      Object.keys(idea.scores).forEach(function(k) {
        html += '<div class="score-badge"><span class="score-val">' + idea.scores[k] + '</span><span class="score-label">/ 10 ' + k.charAt(0).toUpperCase() + k.slice(1) + '</span></div>';
      });
    }
    html += '</div>';
    if (idea.revenueEstimate) html += '<div class="revenue">üí∞ ' + esc(idea.revenueEstimate) + '</div>';
    var vc = idea.verdict === 'build' ? 'build' : idea.verdict === 'watch' ? 'watch' : 'skip';
    var vicon = vc === 'build' ? 'üî®' : vc === 'watch' ? 'üëÄ' : '‚è≠Ô∏è';
    html += '<div class="verdict ' + vc + '">' + vicon + ' ' + esc(idea.verdictNote || idea.verdict) + '</div>';
    html += '<div class="expand-content">';
    if (idea.healthcareAngle) {
      html += '<div class="healthcare-angle"><div class="label">‚öïÔ∏è Healthcare Angle</div><p>' + esc(idea.healthcareAngle) + '</p></div>';
    }
    html += '</div>';
    html += '<div class="expand-hint">tap for healthcare analysis ‚ñæ</div>';
    html += '<div class="card-actions">';
    var ideaSaved = isItemSaved('idea', dateStr);
    html += '<div class="action-btn' + (ideaSaved ? ' saved' : '') + '" onclick="event.stopPropagation();toggleSave(\'idea\',\'' + dateStr + '\',\'' + esc(idea.title).replace(/'/g, "\\'") + '\')">' + (ideaSaved ? '‚úÖ Saved' : 'üíæ Save') + '</div>';
    html += '<a class="action-btn" href="' + esc(idea.url) + '" target="_blank" onclick="event.stopPropagation();">üîó View on IdeaBrowser</a>';
    html += '</div></div></div>';
  }

  // ARTICLES
  if (data.articles && data.articles.length) {
    html += '<div class="section"><div class="section-label"><div class="section-icon articles">üì∞</div><div class="section-title">Articles</div></div>';
    data.articles.forEach(function(a, i) {
      var artSaved = isItemSaved('article', dateStr + '-' + i);
      html += '<div class="card article-card expandable" onclick="toggleExpand(this)">';
      html += '<div class="card-title">' + esc(a.title) + '</div>';
      html += '<div class="card-source">' + esc(a.source) + ' ¬∑ ' + esc(a.date) + '</div>';
      html += '<div class="card-body">' + esc(a.takeaway) + '</div>';
      html += '<div class="expand-content">';
      if (a.linkedinAngle) {
        html += '<div class="healthcare-angle" style="border-color:rgba(139,92,246,0.15);background:rgba(139,92,246,0.08);"><div class="label" style="color:var(--forge-purple);">üíº LinkedIn Angle</div><p>' + esc(a.linkedinAngle) + '</p></div>';
      }
      html += '</div>';
      html += '<div class="expand-hint">tap for LinkedIn angle ‚ñæ</div>';
      html += '<div class="card-actions">';
      html += '<div class="action-btn' + (artSaved ? ' saved' : '') + '" onclick="event.stopPropagation();toggleSave(\'article\',\'' + dateStr + '-' + i + '\',\'' + esc(a.title).replace(/'/g, "\\'") + '\')">' + (artSaved ? '‚úÖ Saved' : 'üíæ Save') + '</div>';
      html += '<div class="action-btn" onclick="event.stopPropagation();draftLinkedIn(\'' + esc(a.title).replace(/'/g, "\\'") + '\',\'' + esc(a.takeaway).replace(/'/g, "\\'").replace(/\n/g,'') + '\',\'' + esc(a.linkedinAngle||'').replace(/'/g, "\\'").replace(/\n/g,'') + '\')">‚úçÔ∏è Draft LinkedIn Post</div>';
      html += '<a class="action-btn" href="' + esc(a.url) + '" target="_blank" onclick="event.stopPropagation();">üîó Read</a>';
      html += '</div></div>';
    });
    html += '</div>';
  }

  // LINKEDIN
  if (data.linkedin && data.linkedin.length) {
    html += '<div class="section"><div class="section-label"><div class="section-icon linkedin">üíº</div><div class="section-title">LinkedIn Pulse</div></div>';
    data.linkedin.forEach(function(l) {
      html += '<div class="card linkedin-card">';
      html += '<div class="card-title">' + esc(l.author) + '</div>';
      html += '<div class="card-source">' + esc(l.authorTitle || '') + '</div>';
      html += '<div class="card-body">' + esc(l.insight) + '</div>';
      if (l.tags && l.tags.length) {
        html += '<div class="tags">';
        l.tags.forEach(function(t) { html += '<span class="tag governance">' + esc(t) + '</span>'; });
        html += '</div>';
      }
      html += '<div class="card-actions">';
      html += '<a class="action-btn primary" href="' + esc(l.url) + '" target="_blank">üîó View Post</a>';
      html += '</div></div>';
    });
    html += '</div>';
  }

  // EVENTS
  if (data.events && data.events.length) {
    html += '<div class="section"><div class="section-label"><div class="section-icon events">üìÖ</div><div class="section-title">Events & Webinars</div></div>';
    data.events.forEach(function(e) {
      html += '<div class="card event-card">';
      html += '<div class="card-header"><div><div class="card-title">' + esc(e.name) + '</div>';
      html += '<div class="card-source">üìç ' + esc(e.location || 'Virtual') + ' ¬∑ üóìÔ∏è ' + esc(e.date) + '</div></div></div>';
      if (e.priority) html += '<div class="priority-badge ' + e.priority + '">' + (e.priority === 'high' ? 'üî¥ Must Attend' : 'üü° Worth Watching') + '</div>';
      html += '<div class="card-body">' + esc(e.description || '') + '</div>';
      html += '<div class="card-actions">';
      if (e.url) html += '<a class="action-btn primary" href="' + esc(e.url) + '" target="_blank">üéüÔ∏è Register Now</a>';
      var evtSaved = isItemSaved('event', esc(e.name));
      html += '<div class="action-btn' + (evtSaved ? ' saved' : '') + '" onclick="toggleSave(\'event\',\'' + esc(e.name).replace(/'/g, "\\'") + '\',\'' + esc(e.name).replace(/'/g, "\\'") + '\')">' + (evtSaved ? '‚úÖ Saved' : 'üíæ Save') + '</div>';
      html += '</div></div>';
    });
    html += '</div>';
  }

  // VIDEOS
  if (data.videos && data.videos.length) {
    html += '<div class="section"><div class="section-label"><div class="section-icon video">üé¨</div><div class="section-title">Watch</div></div>';
    data.videos.forEach(function(v) {
      html += '<div class="card video-card">';
      html += '<div class="card-title">' + esc(v.title) + '</div>';
      html += '<div class="card-source">' + esc(v.source || '') + ' ¬∑ ' + esc(v.duration || '') + '</div>';
      if (v.description) html += '<div class="card-body">' + esc(v.description) + '</div>';
      html += '<div class="card-actions">';
      html += '<a class="action-btn primary" href="' + esc(v.url) + '" target="_blank">‚ñ∂Ô∏è Watch</a>';
      html += '</div></div>';
    });
    html += '</div>';
  }

  document.getElementById('tab-today').innerHTML = html;
}

function esc(s) { if (!s) return ''; var d = document.createElement('div'); d.textContent = s; return d.innerHTML; }

function toggleExpand(el) { el.classList.toggle('expanded'); }

function isItemSaved(type, id) { return savedItems.some(function(s) { return s.type === type && s.id === id; }); }

function toggleSave(type, id, title) {
  var idx = savedItems.findIndex(function(s) { return s.type === type && s.id === id; });
  if (idx >= 0) { savedItems.splice(idx, 1); }
  else { savedItems.push({ type: type, id: id, title: title, savedAt: new Date().toISOString() }); }
  localStorage.setItem('forge_saved', JSON.stringify(savedItems));
  renderBriefing(AVAILABLE_DATES[currentDateIdx]);
  renderSaved();
}

function renderSaved() {
  var el = document.getElementById('tab-saved');
  if (!savedItems.length) {
    el.innerHTML = '<div class="saved-empty"><div class="icon">üíæ</div><div style="font-family:Space Grotesk;font-weight:600;margin-bottom:8px;">Nothing saved yet</div><div style="font-size:0.85rem;">Tap üíæ Save on any idea or article to bookmark it here.</div></div>';
    return;
  }
  var html = '<div class="section"><div class="section-label"><div class="section-icon" style="background:rgba(59,130,246,0.15);">üíæ</div><div class="section-title">Saved Items</div></div>';
  savedItems.slice().reverse().forEach(function(s) {
    var icon = s.type === 'idea' ? 'üí°' : s.type === 'article' ? 'üì∞' : 'üìÑ';
    html += '<div class="card article-card"><div class="card-title">' + icon + ' ' + esc(s.title) + '</div>';
    html += '<div class="card-source">' + s.type + ' ¬∑ saved ' + new Date(s.savedAt).toLocaleDateString() + '</div>';
    html += '<div class="card-actions">';
    html += '<div class="action-btn" onclick="toggleSave(\'' + s.type + '\',\'' + s.id + '\',\'' + esc(s.title).replace(/'/g, "\\'") + '\')">üóëÔ∏è Remove</div>';
    html += '</div></div>';
  });
  html += '</div>';
  el.innerHTML = html;
}

function draftLinkedIn(title, takeaway, angle) {
  var post = 'üè• ' + title + '\n\n';
  if (angle) { post += angle + '\n\n'; }
  else { post += takeaway + '\n\n'; }
  post += 'The question for healthcare leaders isn\'t whether to adopt AI ‚Äî it\'s whether you can prove your AI made the right call when it matters most.\n\n';
  post += 'At FORGE Health, we\'re building the infrastructure for defensible clinical AI decisions. Because governance frameworks are great ‚Äî but what controls the decision at runtime?\n\n';
  post += '#HealthcareAI #ClinicalAI #AIGovernance #HealthIT #FORGEHealth';
  document.getElementById('modalPost').textContent = post;
  document.getElementById('modalOverlay').classList.add('show');
}

function closeModal(e) {
  if (!e || e.target === document.getElementById('modalOverlay')) {
    document.getElementById('modalOverlay').classList.remove('show');
  }
}

function copyPost() {
  var text = document.getElementById('modalPost').textContent;
  if (navigator.clipboard) {
    navigator.clipboard.writeText(text).then(function() {
      var btn = document.querySelector('.modal-btn.copy');
      btn.textContent = '‚úÖ Copied!';
      setTimeout(function() { btn.textContent = 'üìã Copy to Clipboard'; }, 2000);
    });
  }
}

function switchTab(tab) {
  document.querySelectorAll('.tab-page').forEach(function(p) { p.classList.remove('active'); });
  document.querySelectorAll('.nav-btn').forEach(function(b) { b.classList.remove('active'); });
  document.getElementById('tab-' + tab).classList.add('active');
  var tabs = ['today', 'saved'];
  var idx = tabs.indexOf(tab);
  if (idx >= 0) document.querySelectorAll('.nav-btn')[idx].classList.add('active');
  if (tab === 'saved') renderSaved();
  window.scrollTo(0, 0);
}

discoverDates();
renderSaved();
</script>
</body>
</html>
